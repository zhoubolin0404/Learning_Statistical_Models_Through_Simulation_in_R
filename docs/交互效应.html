<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 交互效应 | 学习统计模型——通过R模拟(施工中)</title>
  <meta name="description" content="4 交互效应 | 学习统计模型——通过R模拟(施工中)" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="4 交互效应 | 学习统计模型——通过R模拟(施工中)" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 交互效应 | 学习统计模型——通过R模拟(施工中)" />
  
  
  

<meta name="author" content="周博霖" />


<meta name="date" content="2024-06-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="多元回归.html"/>
<link rel="next" href="介绍线性混合效应模型.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX","output/SVG"],
  extensions: ["tex2jax.js","MathMenu.js","MathZoom.js"],
  TeX: {
    extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
  }
});
</script>
<script type="text/javascript"
   src="../../../MathJax/MathJax.js">
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>概述</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#译者按"><i class="fa fa-check"></i>译者按</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#如何引用本书"><i class="fa fa-check"></i>如何引用本书</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#发现问题"><i class="fa fa-check"></i>发现问题？</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#教育者需知"><i class="fa fa-check"></i>教育者需知</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="前言.html"><a href="前言.html"><i class="fa fa-check"></i><b>1</b> 前言</a>
<ul>
<li class="chapter" data-level="1.1" data-path="前言.html"><a href="前言.html#课程目的"><i class="fa fa-check"></i><b>1.1</b> 课程目的</a></li>
<li class="chapter" data-level="1.2" data-path="前言.html"><a href="前言.html#广义线性混合效应模型generalized-linear-mixed-effects-models-glmms"><i class="fa fa-check"></i><b>1.2</b> 广义线性混合效应模型(Generalized Linear Mixed-Effects Models, GLMMs)</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="前言.html"><a href="前言.html#线性模型"><i class="fa fa-check"></i><b>1.2.1</b> 线性模型</a></li>
<li class="chapter" data-level="1.2.2" data-path="前言.html"><a href="前言.html#混合模型"><i class="fa fa-check"></i><b>1.2.2</b> 混合模型</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="前言.html"><a href="前言.html#关于可重复性的说明"><i class="fa fa-check"></i><b>1.3</b> 关于可重复性的说明</a></li>
<li class="chapter" data-level="1.4" data-path="前言.html"><a href="前言.html#基于模拟的方法"><i class="fa fa-check"></i><b>1.4</b> 基于模拟的方法</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="相关和回归.html"><a href="相关和回归.html"><i class="fa fa-check"></i><b>2</b> 相关和回归</a>
<ul>
<li class="chapter" data-level="2.1" data-path="相关和回归.html"><a href="相关和回归.html#相关矩阵correlation-matrices"><i class="fa fa-check"></i><b>2.1</b> 相关矩阵(Correlation matrices)</a></li>
<li class="chapter" data-level="2.2" data-path="相关和回归.html"><a href="相关和回归.html#模拟二元数据"><i class="fa fa-check"></i><b>2.2</b> 模拟二元数据</a></li>
<li class="chapter" data-level="2.3" data-path="相关和回归.html"><a href="相关和回归.html#相关和回归的关系"><i class="fa fa-check"></i><b>2.3</b> 相关和回归的关系</a></li>
<li class="chapter" data-level="2.4" data-path="相关和回归.html"><a href="相关和回归.html#练习"><i class="fa fa-check"></i><b>2.4</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="多元回归.html"><a href="多元回归.html"><i class="fa fa-check"></i><b>3</b> 多元回归</a>
<ul>
<li class="chapter" data-level="3.1" data-path="多元回归.html"><a href="多元回归.html#一个例子如何在统计学上取得好成绩"><i class="fa fa-check"></i><b>3.1</b> 一个例子：如何在统计学上取得好成绩</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="多元回归.html"><a href="多元回归.html#数据导入和可视化"><i class="fa fa-check"></i><b>3.1.1</b> 数据导入和可视化</a></li>
<li class="chapter" data-level="3.1.2" data-path="多元回归.html"><a href="多元回归.html#估计和解释"><i class="fa fa-check"></i><b>3.1.2</b> 估计和解释</a></li>
<li class="chapter" data-level="3.1.3" data-path="多元回归.html"><a href="多元回归.html#使用predict通过线性模型进行预测"><i class="fa fa-check"></i><b>3.1.3</b> 使用<code>predict()</code>通过线性模型进行预测</a></li>
<li class="chapter" data-level="3.1.4" data-path="多元回归.html"><a href="多元回归.html#偏效应可视化"><i class="fa fa-check"></i><b>3.1.4</b> 偏效应可视化</a></li>
<li class="chapter" data-level="3.1.5" data-path="多元回归.html"><a href="多元回归.html#标准化系数"><i class="fa fa-check"></i><b>3.1.5</b> 标准化系数</a></li>
<li class="chapter" data-level="3.1.6" data-path="多元回归.html"><a href="多元回归.html#模型比较"><i class="fa fa-check"></i><b>3.1.6</b> 模型比较</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="多元回归.html"><a href="多元回归.html#处理分类预测变量"><i class="fa fa-check"></i><b>3.2</b> 处理分类预测变量</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="多元回归.html"><a href="多元回归.html#虚拟编码又称处理编码"><i class="fa fa-check"></i><b>3.2.1</b> 虚拟编码(又称“处理”编码)</a></li>
<li class="chapter" data-level="3.2.2" data-path="多元回归.html"><a href="多元回归.html#当k-2时的虚拟编码"><i class="fa fa-check"></i><b>3.2.2</b> 当<span class="math inline">\(k &gt; 2\)</span>时的虚拟编码</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="多元回归.html"><a href="多元回归.html#多元回归和单因素方差分析one-way-anova的等价性"><i class="fa fa-check"></i><b>3.3</b> 多元回归和单因素方差分析(one-way ANOVA)的等价性</a></li>
<li class="chapter" data-level="3.4" data-path="多元回归.html"><a href="多元回归.html#练习答案"><i class="fa fa-check"></i><b>3.4</b> 练习答案</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="交互效应.html"><a href="交互效应.html"><i class="fa fa-check"></i><b>4</b> 交互效应</a>
<ul>
<li class="chapter" data-level="4.1" data-path="交互效应.html"><a href="交互效应.html#cont-by-cat"><i class="fa fa-check"></i><b>4.1</b> 连续变量-分类变量交互效应</a></li>
<li class="chapter" data-level="4.2" data-path="交互效应.html"><a href="交互效应.html#分类变量-分类变量交互效应"><i class="fa fa-check"></i><b>4.2</b> 分类变量-分类变量交互效应</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="交互效应.html"><a href="交互效应.html#认知治疗与药物治疗对情绪的影响"><i class="fa fa-check"></i><b>4.2.1</b> 认知治疗与药物治疗对情绪的影响</a></li>
<li class="chapter" data-level="4.2.2" data-path="交互效应.html"><a href="交互效应.html#因子设计中的效应"><i class="fa fa-check"></i><b>4.2.2</b> 因子设计中的效应</a></li>
<li class="chapter" data-level="4.2.3" data-path="交互效应.html"><a href="交互效应.html#高阶设计higher-order-designs"><i class="fa fa-check"></i><b>4.2.3</b> 高阶设计(Higher-order designs)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="交互效应.html"><a href="交互效应.html#用于因子设计的glm"><i class="fa fa-check"></i><b>4.3</b> 用于因子设计的GLM</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="交互效应.html"><a href="交互效应.html#估计方程estimation-equations"><i class="fa fa-check"></i><b>4.3.1</b> 估计方程(estimation equations)</a></li>
<li class="chapter" data-level="4.3.2" data-path="交互效应.html"><a href="交互效应.html#因子设计app"><i class="fa fa-check"></i><b>4.3.2</b> 因子设计App</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="交互效应.html"><a href="交互效应.html#在因子设计中对分类预测因子进行编码"><i class="fa fa-check"></i><b>4.4</b> 在因子设计中对分类预测因子进行编码</a></li>
<li class="chapter" data-level="4.5" data-path="交互效应.html"><a href="交互效应.html#分类变量的编码方案"><i class="fa fa-check"></i><b>4.5</b> 分类变量的编码方案</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="交互效应.html"><a href="交互效应.html#简单效应-vs.-主效应"><i class="fa fa-check"></i><b>4.5.1</b> 简单效应 vs. 主效应</a></li>
<li class="chapter" data-level="4.5.2" data-path="交互效应.html"><a href="交互效应.html#主要编码方案"><i class="fa fa-check"></i><b>4.5.2</b> 主要编码方案</a></li>
<li class="chapter" data-level="4.5.3" data-path="交互效应.html"><a href="交互效应.html#超过2水平的因子呢"><i class="fa fa-check"></i><b>4.5.3</b> 超过2水平的因子呢？</a></li>
<li class="chapter" data-level="4.5.4" data-path="交互效应.html"><a href="交互效应.html#举例3水平因子"><i class="fa fa-check"></i><b>4.5.4</b> 举例：3水平因子</a></li>
<li class="chapter" data-level="4.5.5" data-path="交互效应.html"><a href="交互效应.html#如何创建你自己的数值型预测变量"><i class="fa fa-check"></i><b>4.5.5</b> 如何创建你自己的数值型预测变量</a></li>
<li class="chapter" data-level="4.5.6" data-path="交互效应.html"><a href="交互效应.html#小结"><i class="fa fa-check"></i><b>4.5.6</b> 小结</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="介绍线性混合效应模型.html"><a href="介绍线性混合效应模型.html"><i class="fa fa-check"></i><b>5</b> 介绍线性混合效应模型</a>
<ul>
<li class="chapter" data-level="5.1" data-path="介绍线性混合效应模型.html"><a href="介绍线性混合效应模型.html#多层数据建模"><i class="fa fa-check"></i><b>5.1</b> 多层数据建模</a></li>
<li class="chapter" data-level="5.2" data-path="介绍线性混合效应模型.html"><a href="介绍线性混合效应模型.html#如何对这些数据进行建模"><i class="fa fa-check"></i><b>5.2</b> 如何对这些数据进行建模</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="介绍线性混合效应模型.html"><a href="介绍线性混合效应模型.html#完全混合一刀切"><i class="fa fa-check"></i><b>5.2.1</b> 完全混合：一刀切</a></li>
<li class="chapter" data-level="5.2.2" data-path="介绍线性混合效应模型.html"><a href="介绍线性混合效应模型.html#不混合"><i class="fa fa-check"></i><b>5.2.2</b> 不混合</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="介绍线性混合效应模型.html"><a href="介绍线性混合效应模型.html#使用混合效果模型的部分混合"><i class="fa fa-check"></i><b>5.3</b> 使用混合效果模型的部分混合</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="介绍线性混合效应模型.html"><a href="介绍线性混合效应模型.html#方差-协方差矩阵"><i class="fa fa-check"></i><b>5.3.1</b> 方差-协方差矩阵</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="介绍线性混合效应模型.html"><a href="介绍线性混合效应模型.html#估计模型参数"><i class="fa fa-check"></i><b>5.4</b> 估计模型参数</a></li>
<li class="chapter" data-level="5.5" data-path="介绍线性混合效应模型.html"><a href="介绍线性混合效应模型.html#解释lmer输出结果并提取估计值"><i class="fa fa-check"></i><b>5.5</b> 解释<code>lmer()</code>输出结果并提取估计值</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="介绍线性混合效应模型.html"><a href="介绍线性混合效应模型.html#固定效应"><i class="fa fa-check"></i><b>5.5.1</b> 固定效应</a></li>
<li class="chapter" data-level="5.5.2" data-path="介绍线性混合效应模型.html"><a href="介绍线性混合效应模型.html#随机效应"><i class="fa fa-check"></i><b>5.5.2</b> 随机效应</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="介绍线性混合效应模型.html"><a href="介绍线性混合效应模型.html#多层app"><i class="fa fa-check"></i><b>5.6</b> 多层app</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="单随机因子线性混合效应模型.html"><a href="单随机因子线性混合效应模型.html"><i class="fa fa-check"></i><b>6</b> 单随机因子线性混合效应模型</a>
<ul>
<li class="chapter" data-level="6.1" data-path="单随机因子线性混合效应模型.html"><a href="单随机因子线性混合效应模型.html#什么时候为什么你想用线性混合效应建模取代传统的分析"><i class="fa fa-check"></i><b>6.1</b> 什么时候，为什么，你想用线性混合效应建模取代传统的分析?</a></li>
<li class="chapter" data-level="6.2" data-path="单随机因子线性混合效应模型.html"><a href="单随机因子线性混合效应模型.html#示例多层数据上的独立样本t检验"><i class="fa fa-check"></i><b>6.2</b> 示例：多层数据上的独立样本<span class="math inline">\(t\)</span>检验</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="单随机因子线性混合效应模型.html"><a href="单随机因子线性混合效应模型.html#什么时候使用随机截距模型是合适的"><i class="fa fa-check"></i><b>6.2.1</b> 什么时候使用随机截距模型是合适的?</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="单随机因子线性混合效应模型.html"><a href="单随机因子线性混合效应模型.html#用回归表达研究设计和进行检验"><i class="fa fa-check"></i><b>6.3</b> 用回归表达研究设计和进行检验</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="单随机因子线性混合效应模型.html"><a href="单随机因子线性混合效应模型.html#水平以上的因子"><i class="fa fa-check"></i><b>6.3.1</b> 2水平以上的因子</a></li>
<li class="chapter" data-level="6.3.2" data-path="单随机因子线性混合效应模型.html"><a href="单随机因子线性混合效应模型.html#多参数检验"><i class="fa fa-check"></i><b>6.3.2</b> 多参数检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="交叉随机因子线性混合效应模型.html"><a href="交叉随机因子线性混合效应模型.html"><i class="fa fa-check"></i><b>7</b> 交叉随机因子线性混合效应模型</a></li>
<li class="chapter" data-level="" data-path="参考文献.html"><a href="参考文献.html"><i class="fa fa-check"></i>参考文献</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">学习统计模型——通过R模拟(施工中)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="交互效应" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> 交互效应<a href="交互效应.html#交互效应" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!-- understand a common fallacy regarding interactions -->
<p>到目前为止，我们一直专注于估计和解释一个变量或预测变量线性组合对响应变量的影响。然而，往往存在这样的情况，一个预测变量对响应变量的影响取决于另一个预测变量。实际上，我们可以在模型中包含一个<strong>交互</strong>项来估计和解释这种依赖性。</p>
<div id="cont-by-cat" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> 连续变量-分类变量交互效应<a href="交互效应.html#cont-by-cat" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>让我们考虑一个简单的虚构例子。假设你对声波干扰对认知表现的影响感兴趣。你的研究中的每个被试在执行一个简单的反应时任务时(尽快对闪光灯做出反应)，被随机分配接受特定水平的声波干扰。你有一种技术，可以自动生成不同水平的背景噪音（例如城市声音的频率和振幅：鸣笛声、钻地声、喧哗声、玻璃破碎声等）。每个参与者在一个随机选择的干扰水平(0到100)下执行任务。你的假设是，城市生活使人们的任务表现更不受声波干扰的影响。你想要比较城市居民和乡村居民(来自更安静的乡村环境)之间干扰与表现关系的差异。</p>
<p>你有3个变量：</p>
<ul>
<li>一个连续响应变量，<code>mean_RT</code>，其较高的水平反映较慢的反应时；</li>
<li>一个连续预测变量，声波干扰水平(<code>dist_level</code>)，其较高的水平表示更多的干扰；</li>
<li>一个两水平的因子，<code>group</code> (城市vs.乡村)。</li>
</ul>
<p>让我们从模拟一些城市组的数据开始。假设在0干扰(静音)下，平均反应时约为450毫秒，且干扰每增加1个单位，反应时就增加约2毫秒。这给了我们以下线性模型：</p>
<p><span class="math display">\[Y_i = 450 + 2 X_i + e_i\]</span></p>
<p>其中<span class="math inline">\(X_i\)</span>是声音干扰的水平。</p>
<p>让我们模拟100名被试的数据，设定<span class="math inline">\(\sigma = 80\)</span>，并在开始之前设置种子。</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="交互效应.html#cb98-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb98-2"><a href="交互效应.html#cb98-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1031</span>)</span>
<span id="cb98-3"><a href="交互效应.html#cb98-3" tabindex="-1"></a></span>
<span id="cb98-4"><a href="交互效应.html#cb98-4" tabindex="-1"></a>n_subj <span class="ot">&lt;-</span> 100L  <span class="co"># 模拟100名被试的数据(注：L是说明100是整数)</span></span>
<span id="cb98-5"><a href="交互效应.html#cb98-5" tabindex="-1"></a>b0_urban <span class="ot">&lt;-</span> <span class="dv">450</span> <span class="co"># y轴截距</span></span>
<span id="cb98-6"><a href="交互效应.html#cb98-6" tabindex="-1"></a>b1_urban <span class="ot">&lt;-</span> <span class="dv">2</span>   <span class="co"># 斜率</span></span>
<span id="cb98-7"><a href="交互效应.html#cb98-7" tabindex="-1"></a></span>
<span id="cb98-8"><a href="交互效应.html#cb98-8" tabindex="-1"></a><span class="co"># 分解表(decomposition table)</span></span>
<span id="cb98-9"><a href="交互效应.html#cb98-9" tabindex="-1"></a>urban <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb98-10"><a href="交互效应.html#cb98-10" tabindex="-1"></a>  <span class="at">subj_id =</span> <span class="dv">1</span><span class="sc">:</span>n_subj,</span>
<span id="cb98-11"><a href="交互效应.html#cb98-11" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">&quot;urban&quot;</span>,</span>
<span id="cb98-12"><a href="交互效应.html#cb98-12" tabindex="-1"></a>  <span class="at">b0 =</span> <span class="dv">450</span>,</span>
<span id="cb98-13"><a href="交互效应.html#cb98-13" tabindex="-1"></a>  <span class="at">b1 =</span> <span class="dv">2</span>,</span>
<span id="cb98-14"><a href="交互效应.html#cb98-14" tabindex="-1"></a>  <span class="at">dist_level =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n_subj, n_subj, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb98-15"><a href="交互效应.html#cb98-15" tabindex="-1"></a>  <span class="at">err =</span> <span class="fu">rnorm</span>(n_subj, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">80</span>),</span>
<span id="cb98-16"><a href="交互效应.html#cb98-16" tabindex="-1"></a>  <span class="at">simple_rt =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> dist_level <span class="sc">+</span> err)</span>
<span id="cb98-17"><a href="交互效应.html#cb98-17" tabindex="-1"></a></span>
<span id="cb98-18"><a href="交互效应.html#cb98-18" tabindex="-1"></a>urban</span></code></pre></div>
<pre><code>## # A tibble: 100 × 7
##    subj_id group    b0    b1 dist_level     err simple_rt
##      &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;int&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1       1 urban   450     2         59  -36.1       532.
##  2       2 urban   450     2         45  128.        668.
##  3       3 urban   450     2         55   23.5       584.
##  4       4 urban   450     2          8    1.04      467.
##  5       5 urban   450     2         47   48.7       593.
##  6       6 urban   450     2         96   88.2       730.
##  7       7 urban   450     2         62  110.        684.
##  8       8 urban   450     2          8  -91.6       374.
##  9       9 urban   450     2         15 -109.        371.
## 10      10 urban   450     2         70   20.7       611.
## # ℹ 90 more rows</code></pre>
<p>让我们绘制创建的数据，并作出最佳拟合线。</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="交互效应.html#cb100-1" tabindex="-1"></a><span class="fu">ggplot</span>(urban, <span class="fu">aes</span>(dist_level, simple_rt)) <span class="sc">+</span> </span>
<span id="cb100-2"><a href="交互效应.html#cb100-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb100-3"><a href="交互效应.html#cb100-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:plot-urban"></span>
<img src="04-%E4%BA%A4%E4%BA%92%E6%95%88%E5%BA%94_files/figure-html/plot-urban-1.png" alt="*声波干扰对简单反应时的影响(城市组)*" width="672" />
<p class="caption">
图4.1: <em>声波干扰对简单反应时的影响(城市组)</em>
</p>
</div>
<p>现在让我们为乡村组模拟数据。我们假设这些被试的截距可能会略高一些，可能是因为他们对技术不太熟悉。最重要的是，我们假设他们的斜率会更陡，因为他们受到噪音的影响更大。大致如下：</p>
<p><span class="math display">\[Y_i = 500 + 3 X_i + e_i\]</span></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="交互效应.html#cb101-1" tabindex="-1"></a>b0_rural <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb101-2"><a href="交互效应.html#cb101-2" tabindex="-1"></a>b1_rural <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb101-3"><a href="交互效应.html#cb101-3" tabindex="-1"></a></span>
<span id="cb101-4"><a href="交互效应.html#cb101-4" tabindex="-1"></a>rural <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb101-5"><a href="交互效应.html#cb101-5" tabindex="-1"></a>  <span class="at">subj_id =</span> <span class="dv">1</span><span class="sc">:</span>n_subj <span class="sc">+</span> n_subj,</span>
<span id="cb101-6"><a href="交互效应.html#cb101-6" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">&quot;rural&quot;</span>,</span>
<span id="cb101-7"><a href="交互效应.html#cb101-7" tabindex="-1"></a>  <span class="at">b0 =</span> b0_rural,</span>
<span id="cb101-8"><a href="交互效应.html#cb101-8" tabindex="-1"></a>  <span class="at">b1 =</span> b1_rural,</span>
<span id="cb101-9"><a href="交互效应.html#cb101-9" tabindex="-1"></a>  <span class="at">dist_level =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n_subj, n_subj, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-10"><a href="交互效应.html#cb101-10" tabindex="-1"></a>  <span class="at">err =</span> <span class="fu">rnorm</span>(n_subj, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">80</span>),</span>
<span id="cb101-11"><a href="交互效应.html#cb101-11" tabindex="-1"></a>  <span class="at">simple_rt =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> dist_level <span class="sc">+</span> err)</span></code></pre></div>
<p>现在让我们把这两组的数据一起画出来。</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="交互效应.html#cb102-1" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(urban, rural)</span>
<span id="cb102-2"><a href="交互效应.html#cb102-2" tabindex="-1"></a></span>
<span id="cb102-3"><a href="交互效应.html#cb102-3" tabindex="-1"></a><span class="fu">ggplot</span>(all_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">fct_relevel</span>(group, <span class="st">&quot;urban&quot;</span>)), </span>
<span id="cb102-4"><a href="交互效应.html#cb102-4" tabindex="-1"></a>       <span class="fu">aes</span>(dist_level, simple_rt, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb102-5"><a href="交互效应.html#cb102-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb102-6"><a href="交互效应.html#cb102-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-7"><a href="交互效应.html#cb102-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> group) <span class="sc">+</span> </span>
<span id="cb102-8"><a href="交互效应.html#cb102-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:combined-plot"></span>
<img src="04-%E4%BA%A4%E4%BA%92%E6%95%88%E5%BA%94_files/figure-html/combined-plot-1.png" alt="*声波干扰对简单反应时的影响(城市和乡村)*" width="672" />
<p class="caption">
图4.2: <em>声波干扰对简单反应时的影响(城市和乡村)</em>
</p>
</div>
<p>这里我们可以很清楚地看到我们在数据中建立的斜率差异。我们如何测试两个斜率是否有显著不同呢？要做到这一点，我们不能做两个单独的回归。我们需要将这两条回归线纳入同一个模型中。我们应该怎么做呢？</p>
<p>请注意，我们可以用”偏移(offset)“值来表示其中一条回归线。我们(任意地)选一组作为我们的”基线”组，并将另一组的y轴截距和斜率表示为相对于这个基准的偏移值。因此，如果我们选择城市组作为基线，我们可以用两个偏移值<span class="math inline">\(\beta_2\)</span>和<span class="math inline">\(\beta_3\)</span>分别表示乡村组的y轴截距和斜率偏移。</p>
<ul>
<li>y轴截距: <span class="math inline">\(\beta_{0\_rural} = \beta_{0\_urban} + \beta_2\)</span></li>
<li>斜率: <span class="math inline">\(\beta_{1\_rural} = \beta_{1\_urban} + \beta_3\)</span></li>
</ul>
<p>我们有城市组参数：<span class="math inline">\(\beta_{0\_urban} = 450\)</span>和<span class="math inline">\(\beta_{1\_urban} = 2\)</span>，乡村组参数：<span class="math inline">\(\beta_{0\_rural} = 500\)</span>和<span class="math inline">\(\beta_{1\_rural} = 3\)</span>。因此可以得出：</p>
<ul>
<li><span class="math inline">\(\beta_2 = 50\)</span>，因为<span class="math inline">\(\beta_{0\_rural} - \beta_{0\_urban} = 500 - 450 = 50\)</span></li>
<li><span class="math inline">\(\beta_3 = 1\)</span>，因为<span class="math inline">\(\beta_{1\_rural} - \beta_{1\_urban} = 3 - 2 = 1\)</span></li>
</ul>
<p>现在我们的两个回归模型是：</p>
<p><span class="math display">\[Y_{i\_urban} = \beta_{0\_urban} + \beta_{1\_urban} X_i + e_i\]</span></p>
<p>和</p>
<p><span class="math display">\[Y_{i\_rural} = (\beta_{0\_urban} + \beta_2) + (\beta_{1\_urban} + \beta_3) X_i + e_i\]</span></p>
<p>好的，看起来我们更接近将这些模型合并为一个单一的回归模型了。这里有最后的技巧。我们定义一个额外的虚拟变量，该变量在城市组中取值为0(我们选择作为”基线”组)，在其他组中取值为1。下框包含我们的最终模型。</p>
<div class="bluebox">
<p><strong>含有连续-分类变量交互效应的回归模型</strong></p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \beta_3 X_{1i} X_{2i} + e_{i}\]</span></p>
<p>其中</p>
<ul>
<li><span class="math inline">\(X_{1i}\)</span>是连续变量</li>
<li><span class="math inline">\(X_{2i}\)</span>是虚拟变量，0表示基线组，1表示其他组</li>
</ul>
<p>参数解释：</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span>: 基线组y轴截距；</li>
<li><span class="math inline">\(\beta_1\)</span>: 基线组斜率；</li>
<li><span class="math inline">\(\beta_2\)</span>: 其他组的y轴截距偏移量；</li>
<li><span class="math inline">\(\beta_3\)</span>: 其他组的斜率偏移量。</li>
</ul>
<p>用R估计：</p>
<p><code>lm(Y ~ X1 + X2 + X1:X2, data)</code>或者简写:</p>
<p><code>lm(Y ~ X1 * X2, data)</code>。这里<code>*</code>的意思是：“所有可能的主效应以及X1和X2的交互”</p>
</div>
<p><span class="math inline">\(\beta_3 X_{1i} X_{2i}\)</span>项是两个预测变量相乘，被称为<strong>交互项(interaction term)</strong>。现在让我们展示上述广义线性模型(GLM)是如何得出两条回归线的。</p>
<p>为了得到城市组的回归方程，我们将0代入到<span class="math inline">\(X_{2i}\)</span>中。得到公式：</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + \beta_2 0 + \beta_3 X_{1i} 0 + e_i\]</span></p>
<p>去掉等于0的项，就得到：</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + e_i,\]</span></p>
<p>这就是基线组(城市组)的回归方程。将其与上面的<span class="math inline">\(Y_{i\_urban}\)</span>进行对比。</p>
<p>将1代入到<span class="math inline">\(X_{2i}\)</span>里会得到乡村组的方程。我们得到：</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + \beta_2 1 + \beta_3 X_{1i} 1 + e_i\]</span></p>
<p>化简和运用一些代数后，也能表示为：</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_2 + (\beta_1 + \beta_3) X_{1i} + e_i.\]</span></p>
<p>将其和上面的<span class="math inline">\(Y_{i\_rural}\)</span>进行对比。虚拟编码起作用了！</p>
<p>我们如何在R中估计回归系数？假设我们想检验两条线的斜率是否不同。注意，这实际上只是检验原假设<span class="math inline">\(\beta_3 = 0\)</span>，因为<span class="math inline">\(\beta_3\)</span>是我们的斜率偏移量。如果这个参数为0，意味着两个组具有相同的斜率(尽管它们可以有不同的截距)。换句话说，这意味着两条斜线是<strong>平行的</strong>。如果它非0，这意味着两个组具有不同的斜率，也就是说，两条斜线<strong>不平行</strong>。</p>
<div class="yellowbox">
<p><strong>样本中的平行线 vs. 总体中的平行线</strong></p>
<p>我刚刚提到，两条不平行的线意味着分类预测变量和连续预测变量之间存在<em>交互效应</em>，而平行的线则意味着不存在交互效应。要明确的是，我所说的平行与否是指在总体(population)中的情况。在样本(sample)中的平行与否不仅取决于它们在总体中的情况，还取决于测量和抽样引入的偏差。总体中是平行的线，在样本中却极有可能出现斜率不同的线，尤其是在样本量较小的情况下。</p>
<p>通常，你会对总体中斜率相同与否感兴趣，而不是样本中的情况。因此，你不能仅仅看样本数据的图表就推断出”线不平行，因此存在交互效应”，或相反”线看起来平行，所以没有交互效应”。你必须进行推论统计检验。</p>
<p>当交互项在某个<span class="math inline">\(\alpha\)</span>水平(如0.05)上具有统计显著性时，你会拒绝交互系数为0的原假设(如<span class="math inline">\(H_0: \beta_3 = 0\)</span>)，这意味着在总体中这些线不是平行的。</p>
<p>然而，交互项不显著并<em>不一定</em>意味着在总体中这些线是平行的。它们可能是平行的，但也可能不是，而你的研究只是缺乏足够的统计效力(power)来检测出差异。</p>
<p>为了获得关于原假设的证据，最好的方法是进行所谓的等效性检验(equivalence test)。在这个检验中你试图拒绝一个原假设，该原假设是总体效应大于某个你感兴趣的最小效应值；教程详见<span class="citation">(<a href="#ref-Lakens_Scheel_Isager_2018">Lakens et al., 2018</a>)</span>。</p>
</div>
<p>我们已经创建了结合两组模拟数据的数据集<code>all_data</code>。我们使用R公式语法表示模型的方式是<code>Y ~ X1 + X2 + X1:X2</code>，其中<code>X1:X2</code>告诉R创建一个预测变量，该预测变量是<code>X1</code>和<code>X2</code>的乘积。还有一个简写方式<code>Y ~ X1 * X2</code>，它告诉R计算所有可能的主效应和交互效应。首先，我们将向模型添加一个虚拟预测变量，并将结果存储在<code>all_data2</code>中。</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="交互效应.html#cb103-1" tabindex="-1"></a>all_data2 <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="交互效应.html#cb103-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grp =</span> <span class="fu">if_else</span>(group <span class="sc">==</span> <span class="st">&quot;rural&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="交互效应.html#cb104-1" tabindex="-1"></a>sonic_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(simple_rt <span class="sc">~</span> dist_level <span class="sc">+</span> grp <span class="sc">+</span> dist_level<span class="sc">:</span>grp,</span>
<span id="cb104-2"><a href="交互效应.html#cb104-2" tabindex="-1"></a>                all_data2)</span>
<span id="cb104-3"><a href="交互效应.html#cb104-3" tabindex="-1"></a></span>
<span id="cb104-4"><a href="交互效应.html#cb104-4" tabindex="-1"></a><span class="fu">summary</span>(sonic_mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = simple_rt ~ dist_level + grp + dist_level:grp, data = all_data2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -261.130  -50.749    3.617   62.304  191.211 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    460.1098    15.5053  29.674  &lt; 2e-16 ***
## dist_level       1.9123     0.2620   7.299 7.07e-12 ***
## grp              4.8250    21.7184   0.222    0.824    
## dist_level:grp   1.5865     0.3809   4.166 4.65e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 81.14 on 196 degrees of freedom
## Multiple R-squared:  0.5625, Adjusted R-squared:  0.5558 
## F-statistic: 83.99 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="purplebox">
<p><strong>练习</strong></p>
<p>在下面的空格中输入你的答案，至少保留两位小数。</p>
<p>给定回归模型</p>
<p><span class="math display">\[Y_{i} = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \beta_3 X_{1i} X_{2i} + e_{i}\]</span></p>
<p>(其中<span class="math inline">\(X_{1i}\)</span>是连续预测变量，<span class="math inline">\(X_{2i}\)</span>是分类预测变量)且上方给出了<code>lm()</code>的输出结果，填写以下参数的估计值。</p>
<ul>
<li><span class="math inline">\(\hat{\beta}_0\)</span>: <input class='webex-solveme nospaces' data-tol='0.01' size='4' data-answer='["460.109764033163"]'/></li>
<li><span class="math inline">\(\hat{\beta}_1\)</span>: <input class='webex-solveme nospaces' data-tol='0.01' size='4' data-answer='["1.91232184349596"]'/></li>
<li><span class="math inline">\(\hat{\beta}_2\)</span>: <input class='webex-solveme nospaces' data-tol='0.01' size='4' data-answer='["4.82504807369757"]'/></li>
<li><span class="math inline">\(\hat{\beta}_3\)</span>: <input class='webex-solveme nospaces' data-tol='0.01' size='4' data-answer='["1.58653315274424"]'/></li>
</ul>
<p>根据这些参数估计，(基线)城市组的回归线为:</p>
<p><span class="math inline">\(Y_i =\)</span> <input class='webex-solveme nospaces' data-tol='0.01' size='2' data-answer='["460.109764033163"]'/> <span class="math inline">\(+\)</span> <input class='webex-solveme nospaces' data-tol='0.01' size='2' data-answer='["1.91232184349596"]'/> <span class="math inline">\(X_{1i}\)</span></p>
<p>乡村组的：</p>
<p><span class="math inline">\(Y_i =\)</span> <input class='webex-solveme nospaces' data-tol='0.01' size='2' data-answer='["464.934812106861"]'/> <span class="math inline">\(+\)</span> <input class='webex-solveme nospaces' data-tol='0.01' size='2' data-answer='["3.4988549962402"]'/> <span class="math inline">\(X_{1i}\)</span></p>
<div class="webex-solution">
<button>
展开答案
</button>
<ul>
<li><span class="math inline">\(\beta_0=\)</span> 460.11</li>
<li><span class="math inline">\(\beta_1=\)</span> 1.91</li>
<li><span class="math inline">\(\beta_2=\)</span> 4.83</li>
<li><span class="math inline">\(\beta_3=\)</span> 1.59</li>
</ul>
<p>城市组的回归线是：</p>
<p><span class="math inline">\(Y_i = \beta_0 + \beta_1 X_{1i}\)</span>即</p>
<p><span class="math inline">\(Y_i =\)</span> 460.11 <span class="math inline">\(+\)</span> 1.91 <span class="math inline">\(X_{1i}\)</span></p>
<p>乡村组的是：</p>
<p><span class="math inline">\(Y_i = \beta_0 + \beta_2 + \left(\beta_1 + \beta_3\right) X_{1i}\)</span>即</p>
<p><span class="math inline">\(Y_i=\)</span> 464.93 <span class="math inline">\(+\)</span> 3.5 <span class="math inline">\(X_{1i}\)</span></p>
</div>
</div>
</div>
<div id="分类变量-分类变量交互效应" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> 分类变量-分类变量交互效应<a href="交互效应.html#分类变量-分类变量交互效应" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>因子设计(factorial design)</strong>在心理学中很常见，通常使用基于ANOVA的技术进行分析，这可能掩盖了ANOVA与回归一样也假设了一个潜在的线性模型的事实。</p>
<p>因子是一种所有预测变量(自变量，IVs)都是分类变量的设计：每个都是具有固定数量<strong>水平</strong>的<strong>因子</strong>。在一个全因子设计(full-factorial design)中，因子之间完全交叉，以表示每种可能的因子组合。我们称每个唯一的组合为设计的一个<strong>单元(cell)</strong>。你经常会听到设计被称为“二乘二(two-by-two)设计”(2x2)，这意味着有2个因子，每个因子有2个水平。一个“三乘三设计”(3x3)是其中有2个因子，每个因子有3个水平的设计；一个“二乘二乘二设计”(2x2x2)是其中有3个因子，每个因子有2个水平，以此类推。</p>
<p>通常，因子设计都以表格形式给出，显示所有因子水平的组合。下面是一个2x2设计的表格表示。</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(B_2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{11}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{12}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{21}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{22}\)</span>
</td>
</tr>
</tbody>
</table>
<p>一个3x2设计可能如下所示。</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(B_2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{11}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{12}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{21}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{22}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_3\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{31}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(AB_{32}\)</span>
</td>
</tr>
</tbody>
</table>
<p>最后是一个2x2x2设计.</p>
<p><span class="math display">\[C_1\]</span></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(B_2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{111}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{121}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{211}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{221}\)</span>
</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[C_2\]</span></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(B_2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{112}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{122}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{212}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(ABC_{222}\)</span>
</td>
</tr>
</tbody>
</table>
<div class="yellowbox">
<p>不要混淆<strong>因子</strong>和<strong>水平</strong>！</p>
<p>如果你听说一个研究有三个处理组(处理组A、处理组B和对照组)，这不是一个“三因子(three-factor, three-way)设计”。这是一个单因子(one-factor, one-way)设计，具有一个三水平因子(处理条件)。</p>
<p>不存在只有一个水平的因子。</p>
</div>
<p>你可以通过将每个因子的水平数相乘来确定设计中有多少个单元。因此，一个2x3x4设计将在设计中有24个单元。</p>
<div id="认知治疗与药物治疗对情绪的影响" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> 认知治疗与药物治疗对情绪的影响<a href="交互效应.html#认知治疗与药物治疗对情绪的影响" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>让我们考虑一个简单的因子设计，并思考我们的数据可能展示方式。在从这个具体例子中了解概念之后，我们将将其映射到更抽象的统计术语上。</p>
<p>想象一下，你正在进行一项研究，内容是两种不同类型的治疗(认知疗法和药物疗法)对抑郁症患者的影响。一半的被试被随机分配接受认知行为疗法(Cognitive Behavioral Therapy, CBT)，另一半接受其他控制操作(no-CBT)。此外，你通过随机分配进一步将你的患者分为两组：药物治疗组(接受抗抑郁药物, drug)和对照组(接受安慰剂, placebo)。接受治疗(或对照/安慰剂)后，你使用一个评分标准来测量他们的情绪，较高的数字对应较积极的情绪。</p>
<p>让我们想象一下，下面我们得到的均值是不受测量或抽样误差影响的总体均值。我们将花一点时间考虑3种不同的可能结果，以及它们暗示这些疗法如何独立或交互地影响情绪。</p>
<div class="yellowbox">
<p>在分类变量-连续变量交互效应部分关于的总体和样本的提醒在这里同样适用。除非模拟数据，你几乎<strong>永远不会</strong>知道你正在研究的任何总体的真实均值。下面，我们讨论的是你实际知道总体均值并且可以在没有任何统计测试的情况下得出结论的假设情况。你观察到的任何真实样本均值都会包含抽样和测量误差，你所做的任何推断都将取决于统计检验的结果，而不是观察到的均值。</p>
</div>
<div id="情景a" class="section level4 unnumbered hasAnchor">
<h4>情景A<a href="交互效应.html#情景a" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:scenario-a-plot"></span>
<img src="04-%E4%BA%A4%E4%BA%92%E6%95%88%E5%BA%94_files/figure-html/scenario-a-plot-1.png" alt="*情景A, 单元平均值图*" width="50%" />
<p class="caption">
图4.3: <em>情景A, 单元平均值图</em>
</p>
</div>
<p>下面是一个<strong>单元均值(cell mean)</strong>和<strong>边际均值(marginal mean)</strong>的表格。单元均值是设计的每个单元中因变量(情绪)的平均值。边际均值(在表格的边缘)提供了每行和每列的均值。</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
No CBT
</th>
<th style="text-align:right;">
CBT
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Placebo
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Drug
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
70
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>如果这是我们的结果，你会得出什么结论？认知疗法对情绪有影响吗？药物疗法呢？对于这两个问题的答案都是肯定的：接受CBT的人平均心情(70；第2列的均值)比没有接受的人高出20(50；第1列的均值)。</p>
<p>同样，接受抗抑郁药物的人情绪(70；第2行均值)相对于接受安慰剂的人(50; 第1行均值)更好。</p>
<p>现在我们还可以问下个问题：<strong>认知疗法的效果是否取决于患者是否同时接受药物疗法</strong>？答案是否定的。看看为什么，注意到对于安慰剂组(第1行)，认知疗法使情绪提高了20分(从40提高到60)。但对于药物组来说也是一样的：从60提高到80也是20分的提高。因此，没有证据表明一个因素对心情的影响取决于另一个因素。</p>
</div>
<div id="情景b" class="section level4 unnumbered hasAnchor">
<h4>情景B<a href="交互效应.html#情景b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:scenario-b-plot"></span>
<img src="04-%E4%BA%A4%E4%BA%92%E6%95%88%E5%BA%94_files/figure-html/scenario-b-plot-1.png" alt="*情景B, 单元平均值图*" width="50%" />
<p class="caption">
图4.4: <em>情景B, 单元平均值图</em>
</p>
</div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
No CBT
</th>
<th style="text-align:right;">
CBT
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Placebo
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Drug
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>在这种情景下，我们也发现CBT改善了情绪(同样提高了20分)，但药物疗法没有效果(第1行和第2行的边际均值都是50)。我们还可以看到，CBT的效果也不依赖于药物疗法：每行都有20分的提高。</p>
</div>
<div id="情景c" class="section level4 unnumbered hasAnchor">
<h4>情景C<a href="交互效应.html#情景c" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="figure"><span style="display:block;" id="fig:scenario-c-plot"></span>
<img src="04-%E4%BA%A4%E4%BA%92%E6%95%88%E5%BA%94_files/figure-html/scenario-c-plot-1.png" alt="*情景C, 单元平均值图*" width="50%" />
<p class="caption">
图4.5: <em>情景C, 单元平均值图</em>
</p>
</div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
No CBT
</th>
<th style="text-align:right;">
CBT
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Placebo
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Drug
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:left;">
70
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>根据前面的逻辑，我们发现总体上接受认知疗法的人相比于对照组，情绪有所提升(75分对45分)，而接受药物疗法的人相比于安慰剂组，情绪也有所提升(70分对50分)。但这里还有其他情况：认知疗法对情绪的影响<strong>在同时接受药物疗法的患者中更明显</strong>。对于服用抗抑郁药的患者，情绪相对于对照组提高了40分(从50分到90分；表中的第2行)。对于接受安慰剂的患者，情绪只提高了20分，从40分到60分(表中的第1行)。因此，在这个假设情景中，<strong>认知疗法的效果取决于是否同时进行药物疗法</strong>。</p>
</div>
</div>
<div id="因子设计中的效应" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> 因子设计中的效应<a href="交互效应.html#因子设计中的效应" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>如果你理解了上一节描述的基本效应模式，那么你就准备好将这些概念映射到统计语言上了。</p>
<div id="主效应main-effect" class="section level4 hasAnchor" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> 主效应(main effect)<a href="交互效应.html#主效应main-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>主效应</strong>：在<strong>忽略</strong>设计中其他因子的情况下，一个因子对因变量的效应。</p>
<p>主效应的检验是对边际均值是否等价的检验。因此，在上述场景A中，当你比较药物治疗的行均值时，你是在评估该因子对情绪的主效应。原假设是这两个边际均值相等：</p>
<p><span class="math display">\[\bar{Y}_{1..} = \bar{Y}_{2..}\]</span></p>
<p>其中<span class="math inline">\(Y_{i..}\)</span>是不考虑列因子的情况下<span class="math inline">\(i\)</span>行的平均值。</p>
<p>如果你有一个因子有<span class="math inline">\(k\)</span>水平，且<span class="math inline">\(k &gt; 2\)</span>，此时主效应的原假设是：</p>
<p><span class="math display">\[\bar{Y}_{1..} = \bar{Y}_{2..} = \ldots = \bar{Y}_{k..},\]</span></p>
<p>即所有的行(或列)都是相等的。</p>
</div>
<div id="简单效应simple-effect" class="section level4 hasAnchor" number="4.2.2.2">
<h4><span class="header-section-number">4.2.2.2</span> 简单效应(simple effect)<a href="交互效应.html#简单效应simple-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>简单效应</strong>是指在另一个因子的特定水平上(将该因子保持在特定值)，一个因子的效应。</p>
<p>例如，在情景C中，我们讨论了CBT对抗抑郁药组被试的效应。在这种情况下，对于接受抗抑郁药的被试来说，CBT的简单效应是40个单位。</p>
<p>我们也可以讨论药物治疗对接受认知疗法的患者的简单效应。在情景C中，这体现为情绪得分从60增加到90(第2列)。</p>
</div>
<div id="交互效应-1" class="section level4 hasAnchor" number="4.2.2.3">
<h4><span class="header-section-number">4.2.2.3</span> 交互效应<a href="交互效应.html#交互效应-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>当一个变量的效应在另一个变量的各个水平上不同的时候，我们称之为存在<strong>交互效应</strong>。</p>
<p>更像数学定义的表述是，当一个因子的简单效应在另一个因子的各个水平上不同时，就存在交互效应。我们在情景C中看到了这一点，CBT对抗抑郁药组的效果提升了40个单位，而对安慰剂组的效果只提升了20个单位。也许抗抑郁药带来的情绪提升使患者更容易接受CBT。</p>
<p>关键在于，当A的简单效应在B的各个水平上不同时，我们称A和B之间存在简单交互效应。你也可以检查B的简单效应在A上是否不同。如果其中一个陈述为真，另一个陈述也必为真，因此查看简单效应的方式并不重要。</p>
</div>
</div>
<div id="高阶设计higher-order-designs" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> 高阶设计(Higher-order designs)<a href="交互效应.html#高阶设计higher-order-designs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>双因子设计(也称为“two-way”)在心理学和神经科学中非常常见，但有时你也会遇到超过两个因子的设计，比如2x2x2设计。</p>
<p>为了计算不同类型效应的数量，我们使用下面的公式，这个公式给出了从<span class="math inline">\(n\)</span>个元素中取<span class="math inline">\(k\)</span>个元素的可能组合数：</p>
<p><span class="math display">\[\frac{n!}{k!(n - k)!}\]</span></p>
<p>相比于实际上的手算，我们可以在R中使用<code>choose(n, k)</code>函数。</p>
<p>对于有<span class="math inline">\(n\)</span>个因子的设计，你会有：</p>
<ul>
<li><span class="math inline">\(n\)</span>个主效应；</li>
<li><span class="math inline">\(\frac{n!}{2!(n - 2)!}\)</span>个2因素交互效应；</li>
<li><span class="math inline">\(\frac{n!}{3!(n - 3)!}\)</span>个3因素交互效应；</li>
<li><span class="math inline">\(\frac{n!}{4!(n - 4)!}\)</span>个4因素交互效应…以此类推。</li>
</ul>
<p>因此，如果我们有一个3因子设计，如一个2x2x2设计，其中包含因子<span class="math inline">\(A\)</span>，<span class="math inline">\(B\)</span>和<span class="math inline">\(C\)</span>，我们将有3个主效应：<span class="math inline">\(A\)</span>，<span class="math inline">\(B\)</span>和<span class="math inline">\(C\)</span>；<code>choose(3, 2)</code> = 3个2因素交互效应：<span class="math inline">\(AB\)</span>，<span class="math inline">\(AC\)</span>和<span class="math inline">\(BC\)</span>，以及<code>choose(3, 3)</code> = 1个3因素交互效应：<span class="math inline">\(ABC\)</span>。</p>
<p>3因素交互效应很难解释，但它们意味着任意两个给定因子之间的<strong>简单交互效应</strong>会随着第3个因子的水平变化而不同。例如，它可能意味着<span class="math inline">\(C_1\)</span>处的<span class="math inline">\(AB\)</span>交互效应与<span class="math inline">\(C_2\)</span>处的<span class="math inline">\(AB\)</span>交互效应不同。</p>
<p>如果你有一个4因子设计，你将会有四个主效应，<code>choose(4, 2)</code> = 6个2因素交互效应，<code>choose(4, 3)</code> = 4个3因素交互效应，以及1个4因素交互效应。从4因子设计中解释结果几乎是不可能的，所以请保持你的设计简单！</p>
<div class="yellowbox">
<p><strong>常见错误</strong></p>
<p>比较简单效应的显著性<strong>不等于</strong>检验简单效应是否有显著差异。</p>
</div>
</div>
</div>
<div id="用于因子设计的glm" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> 用于因子设计的GLM<a href="交互效应.html#用于因子设计的glm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>现在让我们看一下这些模型背后的数学。通常情况下，你会看到为2x2因子设计编写的方差分析(ANOVA)的GLM使用“ANOVA”符号，如下所示：</p>
<p><span class="math display">\[Y_{ijk} = \mu + A_i + B_j + AB_{ij} + S(AB)_{ijk}.\]</span></p>
<p>在上方公式中：</p>
<ul>
<li><span class="math inline">\(Y_{ijk}\)</span>表示在因子<span class="math inline">\(A\)</span>的第<span class="math inline">\(i\)</span>个水平和因子<span class="math inline">\(B\)</span>的第<span class="math inline">\(j\)</span>个水平中观测到的<span class="math inline">\(k\)</span>的值；</li>
<li><span class="math inline">\(\mu\)</span>表示总体均值；</li>
<li><span class="math inline">\(A_i\)</span>表示因子<span class="math inline">\(A\)</span>在<span class="math inline">\(A\)</span>的第<span class="math inline">\(i\)</span>个水平上的主效应；</li>
<li><span class="math inline">\(B_j\)</span>表示因子<span class="math inline">\(B\)</span>在<span class="math inline">\(B\)</span>的第<span class="math inline">\(j\)</span>个水平上的主效应；</li>
<li><span class="math inline">\(AB_{ij}\)</span>表示在<span class="math inline">\(A\)</span>的第<span class="math inline">\(i\)</span>个水平和<span class="math inline">\(B\)</span>的第<span class="math inline">\(j\)</span>个水平处的<span class="math inline">\(AB\)</span>交互效应；</li>
<li><span class="math inline">\(S(AB)_{ijk}\)</span>表示残差。</li>
</ul>
<p>一个重要的数学事实是，各个主效应和交互效应的总和为零，通常写成：</p>
<ul>
<li><span class="math inline">\(\Sigma_i A_i = 0\)</span>;</li>
<li><span class="math inline">\(\Sigma_j B_j = 0\)</span>;</li>
<li><span class="math inline">\(\Sigma_{ij} AB_{ij} = 0\)</span>。</li>
</ul>
<p>理解这些效应的最好方法是查看分解表。研究下面的分解表，该表包含了从具有因子<span class="math inline">\(A\)</span>和<span class="math inline">\(B\)</span>的2x2设计中获取的12个模拟观测值。提供了索引<span class="math inline">\(i\)</span>、<span class="math inline">\(j\)</span>和<span class="math inline">\(k\)</span>，只是为了帮助你跟踪正在处理的观测值。请记住，<span class="math inline">\(i\)</span>表示因子<span class="math inline">\(A\)</span>的水平，<span class="math inline">\(j\)</span>表示因子<span class="math inline">\(B\)</span>的水平，<span class="math inline">\(k\)</span>表示单元<span class="math inline">\(AB_{ij}\)</span>内的观测值编号。</p>
<pre><code>## # A tibble: 12 × 9
##        Y     i     j     k    mu   A_i   B_j AB_ij   err
##    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
##  1    11     1     1     1    10     4    -2    -1     0
##  2    14     1     1     2    10     4    -2    -1     3
##  3     8     1     1     3    10     4    -2    -1    -3
##  4    17     1     2     1    10     4     2     1     0
##  5    15     1     2     2    10     4     2     1    -2
##  6    19     1     2     3    10     4     2     1     2
##  7     8     2     1     1    10    -4    -2     1     3
##  8     4     2     1     2    10    -4    -2     1    -1
##  9     3     2     1     3    10    -4    -2     1    -2
## 10    10     2     2     1    10    -4     2    -1     3
## 11     7     2     2     2    10    -4     2    -1     0
## 12     4     2     2     3    10    -4     2    -1    -3</code></pre>
<div id="估计方程estimation-equations" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> 估计方程(estimation equations)<a href="交互效应.html#估计方程estimation-equations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>这些是你在ANOVA中用来估计效应的方程。</p>
<ul>
<li><span class="math inline">\(\hat{\mu} = Y_{...}\)</span></li>
<li><span class="math inline">\(\hat{A}_i = Y_{i..} - \hat{\mu}\)</span></li>
<li><span class="math inline">\(\hat{B}_j = Y_{.j.} - \hat{\mu}\)</span></li>
<li><span class="math inline">\(\widehat{AB}_{ij} = Y_{ij.} - \hat{\mu} - \hat{A}_i - \hat{B}_j\)</span></li>
</ul>
<p>注意，带有下标点的<span class="math inline">\(Y\)</span>变量是<span class="math inline">\(Y\)</span>的均值，忽略了下标中的任何内容。因此，<span class="math inline">\(Y_{...}\)</span>是<span class="math inline">\(Y\)</span>的均值，<span class="math inline">\(Y_{i..}\)</span>是<span class="math inline">\(Y\)</span>在<span class="math inline">\(A\)</span>的第<span class="math inline">\(i\)</span>个水平上的均值，<span class="math inline">\(Y_{.j.}\)</span>是<span class="math inline">\(Y\)</span>在<span class="math inline">\(B\)</span>的第<span class="math inline">\(j\)</span>个水平上的均值，<span class="math inline">\(Y_{ij.}\)</span>是<span class="math inline">\(Y\)</span>在<span class="math inline">\(A\)</span>的第<span class="math inline">\(i\)</span>个水平和<span class="math inline">\(B\)</span>的第<span class="math inline">\(j\)</span>个水平上的均值，即单元均值<span class="math inline">\(ij\)</span>。</p>
</div>
<div id="因子设计app" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> 因子设计App<a href="交互效应.html#因子设计app" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="images/04-interactions_factorial_app.png" /></p>
<p><a href="https://rstudio-connect.psy.gla.ac.uk/factorial" target="_blank">启动这个网页APP</a>，尝试因子设计，直到你理解因子设计中主效应和交互效应的关键概念。</p>
</div>
</div>
<div id="在因子设计中对分类预测因子进行编码" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> 在因子设计中对分类预测因子进行编码<a href="交互效应.html#在因子设计中对分类预测因子进行编码" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>心理学研究(尤其是实验心理学)经常涉及分类自变量。分析这些研究的数据时，需要仔细指定预测变量，因为R中的默认设置对实验情景而言并不理想。主要问题是分类预测变量的默认编码在输出中给出的是<strong>简单效应</strong>而非<strong>主效应</strong>，但后者通常是你所需要的。人们有时没有意识到这一点，误读了他们的输出结果。研究人员有时会报告含有分类预测变量的回归结果，但未明确报告他们是如何编码这些变量的，这使得他们的研究结果难以解读和再现。为了确保可重复性、透明度和准确解释，学习如何“手动”编码分类预测变量并在报告中习惯性地报告这些编码是一个好主意。</p>
<p>由于R的默认设置不适合因子设计，我建议在将分类变量作为线性模型中的预测变量时，应该总是手动编码分类变量。不要将它们包括为<code>factor</code>变量。</p>
</div>
<div id="分类变量的编码方案" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> 分类变量的编码方案<a href="交互效应.html#分类变量的编码方案" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>许多实验研究者在尝试从方差分析(ANOVA)转向使用R进行线性混合效应模型(linear mixed-effects models，LMEMs)时，都会在编码分类预测变量时遇到困难。这比预期的要复杂得多，而R提供的默认设置对于因子实验来说完全不合适。实际上，在因子实验中使用这些默认设置可能会导致研究人员从数据中得出错误的结论。</p>
<p>为了简化问题，我们将从设计因子不超过两水平的情况开始，然后再讨论具有三个以上水平的设计。</p>
<div id="简单效应-vs.-主效应" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> 简单效应 vs. 主效应<a href="交互效应.html#简单效应-vs.-主效应" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>理解<strong>简单效应(simple effect)</strong>和<strong>主效应(main effect)</strong>以及<strong>简单交互效应(simple interaction)</strong>和<strong>主交互效应(main interaction)</strong>在三因素设计中的区别是非常重要的。</p>
<p>在<span class="math inline">\(A{\times}B\)</span>设计中，<span class="math inline">\(A\)</span>的简单效应是<strong>控制</strong><span class="math inline">\(B\)</span>后的<span class="math inline">\(A\)</span>的效应，而<span class="math inline">\(A\)</span>的主效应是<strong>忽略</strong><span class="math inline">\(B\)</span>后<span class="math inline">\(A\)</span>的效应。另一种看待这个问题的方法是考虑因子设计中的单元均值(<span class="math inline">\(\bar{Y}_{11}\)</span>，<span class="math inline">\(\bar{Y}_{12}\)</span>，<span class="math inline">\(\bar{Y}_{21}\)</span>和<span class="math inline">\(\bar{Y}_{22}\)</span>)以及边际均值(<span class="math inline">\(\bar{Y}_{1.}\)</span>，<span class="math inline">\(\bar{Y}_{2.}\)</span>，<span class="math inline">\(\bar{Y}_{.1}\)</span>和<span class="math inline">\(\bar{Y}_{.2}\)</span>)。(下标的点告诉你“忽略”该点的维度；例如：<span class="math inline">\(\bar{Y}_{.1}\)</span>告诉你忽略行变量取第1列的均值)。测试<span class="math inline">\(A\)</span>的主效应是测试原假设<span class="math inline">\(\bar{Y}_{1.}=\bar{Y}_{2.}\)</span>。测试<span class="math inline">\(A\)</span>的简单效应，即在<span class="math inline">\(B\)</span>的特定水平上<span class="math inline">\(A\)</span>的效应，例如，测试原假设<span class="math inline">\(\bar{Y}_{11}=\bar{Y}_{21}\)</span>。</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(B_2\)</span>
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{11}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{12}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{1.}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{21}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{22}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{2.}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.1}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.2}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
<p>区别<strong>简单交互效应</strong>和<strong>主交互效应</strong>的逻辑相同：在<span class="math inline">\(ABC\)</span>设计中，<span class="math inline">\(AB\)</span>的简单交互效应是在<span class="math inline">\(C\)</span>的特定水平上<span class="math inline">\(AB\)</span>交互效应；而<span class="math inline">\(AB\)</span>的主交互效应是<strong>忽略</strong><span class="math inline">\(C\)</span>后<span class="math inline">\(AB\)</span>的交互效应。后者是我们在三因子设计中通常讨论的低阶交互效应(lower-order interaction)。这也是标准ANOVA程序(如R的<code>aov()</code>函数、SPSS、SAS等)输出中所提供的内容。</p>
</div>
<div id="主要编码方案" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> 主要编码方案<a href="交互效应.html#主要编码方案" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>通常，编码方案的选择会影响对数据的解释：</p>
<ol style="list-style-type: decimal">
<li>截距项的解释</li>
<li>因子设计中除最高阶效应和(最高阶)交互效应之外的所有测试的解释。</li>
</ol>
<p>它还会影响混合效应模型中随机效应的解释/估计(详见这篇<a href="https://talklab.psy.gla.ac.uk/simgen/rsonly.html">博客</a>)。如果你的设计只有一个两水平因素，并且使用了<a href="https://www.sciencedirect.com/science/article/pii/S0749596X12001180">最大随机效应结构</a>( maximal random-effects structure)，那么编码方案的选择实际上并不重要。</p>
<p>有许多可能的编码方案(详见<code>?contr.treatment</code>)。最相关的编码方案是<strong>处理(treatment)编码</strong>、<strong>求和(sum)编码</strong>和<strong>偏差(deviation)编码</strong>。求和编码和偏差编码可以被视为<strong>效应编码(effect coding)</strong>的特例——人们通常把那些编码总和为0的编码称为效应编码。</p>
<p>对于2水平因子，你可以使用下面代码：</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Scheme
</th>
<th style="text-align:right;">
<span class="math inline">\(A_1\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(A_2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Treatment (dummy)
</td>
<td style="text-align:right;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Sum
</td>
<td style="text-align:right;">
<span class="math inline">\(-1\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Deviation
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{2}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{1}{2}\)</span>
</td>
</tr>
</tbody>
</table>
<p>默认情况下，R对模型中定义为=factor=的任何变量使用处理编码(详见<code>?factor</code>和<code>?contrasts</code>)。要了解为什么这对因子设计而言并不理想，可以考虑一个2x2x2的因子设计，因子包括<span class="math inline">\(A\)</span>、<span class="math inline">\(B\)</span> 和<span class="math inline">\(C\)</span>。我们将只考虑一个完全的被试内设计，每个被试只有一个观测值，因为这允许我们使用最简单的可能的误差结构(error structure)。我们将使用<code>lm()</code>来拟合一个这样的模型：</p>
<p><code>lm(Y ~ A * B * C)</code></p>
<p>下图详细说明了2x2x2设计的各种单元均值和边际均值的符号。</p>
<p><span class="math display">\[C_1\]</span></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(B_2\)</span>
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{121}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{1.1}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{211}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{221}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{2.1}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.11}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.21}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[C_2\]</span></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
<span class="math inline">\(B_1\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(B_2\)</span>
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{112}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{122}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{1.2}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A_2\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{212}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{222}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{2.2}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.12}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.22}\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
<p>下表提供了在三种不同编码方案下模型中各种效应的解释。注意，<span class="math inline">\(Y\)</span>是因变量，下标的点表示“忽略”相应的维度。因此，<span class="math inline">\(\bar{Y}_{.1.}\)</span>是B_1的均值(忽略因子<span class="math inline">\(A\)</span>和因子<span class="math inline">\(C\)</span>)，而<span class="math inline">\(\bar{Y}_{...}\)</span>是“总均值”(忽略所有因子)。</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
term
</th>
<th style="text-align:center;">
treatment
</th>
<th style="text-align:center;">
sum
</th>
<th style="text-align:center;">
deviation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{...}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{...}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(A\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{211} - \bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{2..} - \bar{Y}_{1..})}{2}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{2..} - \bar{Y}_{1..}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(B\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{121} - \bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{.2.} - \bar{Y}_{.1.})}{2}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{.2.} - \bar{Y}_{.1.}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(C\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{112} - \bar{Y}_{111}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{..2} - \bar{Y}_{..1})}{2}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{Y}_{..2} - \bar{Y}_{..1}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(AB\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{221} - \bar{Y}_{121}) - (\bar{Y}_{211} - \bar{Y}_{111})\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{22.} - \bar{Y}_{12.}) - (\bar{Y}_{21.} - \bar{Y}_{11.})}{4}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{22.} - \bar{Y}_{12.}) - (\bar{Y}_{21.} - \bar{Y}_{11.})\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(AC\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{212} - \bar{Y}_{211}) - (\bar{Y}_{112} - \bar{Y}_{111})\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{2.2} - \bar{Y}_{1.2}) - (\bar{Y}_{2.1} - \bar{Y}_{1.1})}{4}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{2.2} - \bar{Y}_{1.2}) - (\bar{Y}_{2.1} - \bar{Y}_{1.1})\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(BC\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{122} - \bar{Y}_{112}) - (\bar{Y}_{121} - \bar{Y}_{111})\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{(\bar{Y}_{.22} - \bar{Y}_{.12}) - (\bar{Y}_{.21} - \bar{Y}_{.11})}{4}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((\bar{Y}_{.22} - \bar{Y}_{.12}) - (\bar{Y}_{.21} - \bar{Y}_{.11})\)</span>
</td>
</tr>
</tbody>
</table>
<p>对于三因子<span class="math inline">\(A \times B \times C\)</span>的交互效应：</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
scheme
</th>
<th style="text-align:center;">
interpretation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
treatment
</td>
<td style="text-align:center;">
<span class="math inline">\(\displaystyle\left[\displaystyle\left(\bar{Y}_{221} - \bar{Y}_{121}\right) - \displaystyle\left(\bar{Y}_{211} - \bar{Y}_{111}\right)\right] - \displaystyle\left[\displaystyle\left(\bar{Y}_{222} - \bar{Y}_{122}\right) - \displaystyle\left(\bar{Y}_{212} - \bar{Y}_{112}\right)\right]\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
sum
</td>
<td style="text-align:center;">
<span class="math inline">\(\frac{\displaystyle\left[\displaystyle\left(\bar{Y}_{221} - \bar{Y}_{121}\right) - \displaystyle\left(\bar{Y}_{211} - \bar{Y}_{111}\right)\right] - \displaystyle\left[\displaystyle\left(\bar{Y}_{222} - \bar{Y}_{122}\right) - \displaystyle\left(\bar{Y}_{212} - \bar{Y}_{112}\right)\right]}{8}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
deviation
</td>
<td style="text-align:center;">
<span class="math inline">\(\displaystyle\left[\displaystyle\left(\bar{Y}_{221} - \bar{Y}_{121}\right) - \displaystyle\left(\bar{Y}_{211} - \bar{Y}_{111}\right)\right] - \displaystyle\left[\displaystyle\left(\bar{Y}_{222} - \bar{Y}_{122}\right) - \displaystyle\left(\bar{Y}_{212} - \bar{Y}_{112}\right)\right]\)</span>
</td>
</tr>
</tbody>
</table>
<p>请注意，尽管求和编码的参数估计值为其他方案的八分之一，但<span class="math inline">\(A \times B \times C\)</span>的推断检验结果全部相同。对于所有低阶效应(lower-order effects)，求和编码和偏差编码将给出不同的参数估计，但相同的推断结果。这两种编码方案都对主效应和主交互效应提供了和3因素ANOVA中相同的检测。相反，处理(虚拟)编码将提供简单效应和简单交互效应的推断检测。因此，如果您感兴趣的是获得方差分析中的“经典”检测结果，请使用求和编码或偏差编码。</p>
</div>
<div id="超过2水平的因子呢" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> 超过2水平的因子呢？<a href="交互效应.html#超过2水平的因子呢" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>一个具有<span class="math inline">\(k\)</span>水平的因子需要<span class="math inline">\(k-1\)</span>个变量。每个预测变量将因子的特定“目标”水平与你(任意地)选择为“基线”的水平进行对比。例如，对于一个3水平因子<span class="math inline">\(A\)</span>，选择<span class="math inline">\(A1\)</span>作为基线，你将有两个预测变量，一个比较<span class="math inline">\(A2\)</span>和<span class="math inline">\(A1\)</span>，另一个比较<span class="math inline">\(A3\)</span>和<span class="math inline">\(A1\)</span>。</p>
<p>对于处理(虚拟)编码，目标水平设置为1，否则为0。</p>
<p>对于求和编码，水平的总和必须为零，因此对于给定的预测变量，目标水平被赋值为1，基线水平被赋值为-1，任何其他水平被赋值为0。</p>
<p>对于偏差编码，值也必须总和为0。无论哪种情况，建议在尝试进行ANOVA式推断时使用偏差编码。根据这种方案，目标水平的值为<span class="math inline">\(\frac{k-1}{k}\)</span>，而任何非目标水平的值为<span class="math inline">\(-\frac{1}{k}\)</span>。</p>
<p><strong>有趣的事实</strong>：对平衡数据进行均值中心处理编码(Mean-centering treatment codes)，你会得到偏差编码。</p>
<p>注：配合这篇<a href="https://zhuanlan.zhihu.com/p/513227882?ssr_src=heifetz">知乎帖子</a>阅读，有助理解。</p>
</div>
<div id="举例3水平因子" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> 举例：3水平因子<a href="交互效应.html#举例3水平因子" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="处理虚拟编码" class="section level4 hasAnchor" number="4.5.4.1">
<h4><span class="header-section-number">4.5.4.1</span> 处理(虚拟)编码<a href="交互效应.html#处理虚拟编码" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="求和编码" class="section level4 hasAnchor" number="4.5.4.2">
<h4><span class="header-section-number">4.5.4.2</span> 求和编码<a href="交互效应.html#求和编码" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="偏差编码" class="section level4 hasAnchor" number="4.5.4.3">
<h4><span class="header-section-number">4.5.4.3</span> 偏差编码<a href="交互效应.html#偏差编码" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{3}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{3}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{2}{3}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{3}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{3}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{2}{3}\)</span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="举例5水平因子" class="section level4 hasAnchor" number="4.5.4.4">
<h4><span class="header-section-number">4.5.4.4</span> 举例：5水平因子<a href="交互效应.html#举例5水平因子" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="处理虚拟编码-1" class="section level4 hasAnchor" number="4.5.4.5">
<h4><span class="header-section-number">4.5.4.5</span> 处理(虚拟)编码<a href="交互效应.html#处理虚拟编码-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
<th style="text-align:right;">
A4v1
</th>
<th style="text-align:right;">
A5v1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="求和编码-1" class="section level4 hasAnchor" number="4.5.4.6">
<h4><span class="header-section-number">4.5.4.6</span> 求和编码<a href="交互效应.html#求和编码-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
<th style="text-align:right;">
A4v1
</th>
<th style="text-align:right;">
A5v1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
A5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="偏差编码-1" class="section level4 hasAnchor" number="4.5.4.7">
<h4><span class="header-section-number">4.5.4.7</span> 偏差编码<a href="交互效应.html#偏差编码-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
level
</th>
<th style="text-align:right;">
A2v1
</th>
<th style="text-align:right;">
A3v1
</th>
<th style="text-align:right;">
A4v1
</th>
<th style="text-align:right;">
A5v1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A2
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{4}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A3
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{4}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A4
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{4}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
A5
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(-\frac{1}{5}\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(\frac{4}{5}\)</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="如何创建你自己的数值型预测变量" class="section level3 hasAnchor" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> 如何创建你自己的数值型预测变量<a href="交互效应.html#如何创建你自己的数值型预测变量" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>让我们假设你的数据包含在如下所示的表<code>dat</code>中。</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="交互效应.html#cb107-1" tabindex="-1"></a> <span class="do">## 创建你自己的数值型预测变量</span></span>
<span id="cb107-2"><a href="交互效应.html#cb107-2" tabindex="-1"></a> <span class="do">## 创建一个示例表</span></span>
<span id="cb107-3"><a href="交互效应.html#cb107-3" tabindex="-1"></a> dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Y =</span> <span class="fu">rnorm</span>(<span class="dv">12</span>),</span>
<span id="cb107-4"><a href="交互效应.html#cb107-4" tabindex="-1"></a>               <span class="at">A =</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">each =</span> <span class="dv">4</span>))</span></code></pre></div>
<div class="webex-solution">
<button>
单击查看示例数据
</button>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Y
</th>
<th style="text-align:left;">
A
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.41
</td>
<td style="text-align:left;">
A1
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.44
</td>
<td style="text-align:left;">
A1
</td>
</tr>
<tr>
<td style="text-align:right;">
-2.01
</td>
<td style="text-align:left;">
A1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:left;">
A1
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.67
</td>
<td style="text-align:left;">
A2
</td>
</tr>
<tr>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
A2
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.61
</td>
<td style="text-align:left;">
A2
</td>
</tr>
<tr>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:left;">
A2
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.44
</td>
<td style="text-align:left;">
A3
</td>
</tr>
<tr>
<td style="text-align:right;">
1.19
</td>
<td style="text-align:left;">
A3
</td>
</tr>
<tr>
<td style="text-align:right;">
0.87
</td>
<td style="text-align:left;">
A3
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.50
</td>
<td style="text-align:left;">
A3
</td>
</tr>
</tbody>
</table>
</div>
<div id="mutateif_elsecase_when-方法操作3水平因子" class="section level4 hasAnchor" number="4.5.5.1">
<h4><span class="header-section-number">4.5.5.1</span> <code>mutate()</code>、<code>if_else()</code>、<code>case_when()</code> 方法操作3水平因子<a href="交互效应.html#mutateif_elsecase_when-方法操作3水平因子" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="处理编码" class="section level4 hasAnchor" number="4.5.5.2">
<h4><span class="header-section-number">4.5.5.2</span> 处理编码<a href="交互效应.html#处理编码" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="交互效应.html#cb108-1" tabindex="-1"></a>  <span class="do">## 3水平因子示例</span></span>
<span id="cb108-2"><a href="交互效应.html#cb108-2" tabindex="-1"></a>  <span class="do">## 处理编码</span></span>
<span id="cb108-3"><a href="交互效应.html#cb108-3" tabindex="-1"></a>  dat_treat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb108-4"><a href="交互效应.html#cb108-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">A2v1 =</span> <span class="fu">if_else</span>(A <span class="sc">==</span> <span class="st">&quot;A2&quot;</span>, 1L, 0L),</span>
<span id="cb108-5"><a href="交互效应.html#cb108-5" tabindex="-1"></a>       <span class="at">A3v1 =</span> <span class="fu">if_else</span>(A <span class="sc">==</span> <span class="st">&quot;A3&quot;</span>, 1L, 0L))</span></code></pre></div>
<div class="webex-solution">
<button>
点击查看结果
</button>
<pre><code>## # A tibble: 12 × 4
##         Y A      A2v1  A3v1
##     &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt;
##  1 -0.410 A1        0     0
##  2 -1.44  A1        0     0
##  3 -2.01  A1        0     0
##  4  0.562 A1        0     0
##  5 -0.671 A2        1     0
##  6  1.00  A2        1     0
##  7 -1.61  A2        1     0
##  8  0.322 A2        1     0
##  9 -0.443 A3        0     1
## 10  1.19  A3        0     1
## 11  0.868 A3        0     1
## 12 -0.500 A3        0     1</code></pre>
</div>
</div>
<div id="求和编码-2" class="section level4 hasAnchor" number="4.5.5.3">
<h4><span class="header-section-number">4.5.5.3</span> 求和编码<a href="交互效应.html#求和编码-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="交互效应.html#cb110-1" tabindex="-1"></a><span class="do">## 求和编码</span></span>
<span id="cb110-2"><a href="交互效应.html#cb110-2" tabindex="-1"></a>dat_sum <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="交互效应.html#cb110-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">A2v1 =</span> <span class="fu">case_when</span>(A <span class="sc">==</span> <span class="st">&quot;A1&quot;</span> <span class="sc">~</span> <span class="sc">-</span>1L, <span class="co"># 基线</span></span>
<span id="cb110-4"><a href="交互效应.html#cb110-4" tabindex="-1"></a>                          A <span class="sc">==</span> <span class="st">&quot;A2&quot;</span> <span class="sc">~</span> 1L,  <span class="co"># 目标</span></span>
<span id="cb110-5"><a href="交互效应.html#cb110-5" tabindex="-1"></a>                          <span class="cn">TRUE</span>      <span class="sc">~</span> 0L), <span class="co"># 其他</span></span>
<span id="cb110-6"><a href="交互效应.html#cb110-6" tabindex="-1"></a>         <span class="at">A3v1 =</span> <span class="fu">case_when</span>(A <span class="sc">==</span> <span class="st">&quot;A1&quot;</span> <span class="sc">~</span> <span class="sc">-</span>1L, <span class="co"># 基线</span></span>
<span id="cb110-7"><a href="交互效应.html#cb110-7" tabindex="-1"></a>                          A <span class="sc">==</span> <span class="st">&quot;A3&quot;</span> <span class="sc">~</span>  1L, <span class="co"># 目标</span></span>
<span id="cb110-8"><a href="交互效应.html#cb110-8" tabindex="-1"></a>                          <span class="cn">TRUE</span>      <span class="sc">~</span> 0L)) <span class="co"># 其他</span></span></code></pre></div>
<div class="webex-solution">
<button>
点击查看结果
</button>
<pre><code>## # A tibble: 12 × 4
##         Y A      A2v1  A3v1
##     &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt;
##  1 -0.410 A1       -1    -1
##  2 -1.44  A1       -1    -1
##  3 -2.01  A1       -1    -1
##  4  0.562 A1       -1    -1
##  5 -0.671 A2        1     0
##  6  1.00  A2        1     0
##  7 -1.61  A2        1     0
##  8  0.322 A2        1     0
##  9 -0.443 A3        0     1
## 10  1.19  A3        0     1
## 11  0.868 A3        0     1
## 12 -0.500 A3        0     1</code></pre>
</div>
</div>
<div id="偏差编码-2" class="section level4 hasAnchor" number="4.5.5.4">
<h4><span class="header-section-number">4.5.5.4</span> 偏差编码<a href="交互效应.html#偏差编码-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="交互效应.html#cb112-1" tabindex="-1"></a><span class="do">## 偏差编码</span></span>
<span id="cb112-2"><a href="交互效应.html#cb112-2" tabindex="-1"></a><span class="do">## 基线A1</span></span>
<span id="cb112-3"><a href="交互效应.html#cb112-3" tabindex="-1"></a>dat_dev <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb112-4"><a href="交互效应.html#cb112-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">A2v1 =</span> <span class="fu">if_else</span>(A <span class="sc">==</span> <span class="st">&quot;A2&quot;</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="co"># 目标A2</span></span>
<span id="cb112-5"><a href="交互效应.html#cb112-5" tabindex="-1"></a>         <span class="at">A3v1 =</span> <span class="fu">if_else</span>(A <span class="sc">==</span> <span class="st">&quot;A3&quot;</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)) <span class="co"># 目标A3</span></span></code></pre></div>
<div class="webex-solution">
<button>
点击查看结果
</button>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="交互效应.html#cb113-1" tabindex="-1"></a>dat_dev</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
##         Y A       A2v1   A3v1
##     &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.410 A1    -0.333 -0.333
##  2 -1.44  A1    -0.333 -0.333
##  3 -2.01  A1    -0.333 -0.333
##  4  0.562 A1    -0.333 -0.333
##  5 -0.671 A2     0.667 -0.333
##  6  1.00  A2     0.667 -0.333
##  7 -1.61  A2     0.667 -0.333
##  8  0.322 A2     0.667 -0.333
##  9 -0.443 A3    -0.333  0.667
## 10  1.19  A3    -0.333  0.667
## 11  0.868 A3    -0.333  0.667
## 12 -0.500 A3    -0.333  0.667</code></pre>
</div>
</div>
</div>
<div id="小结" class="section level3 hasAnchor" number="4.5.6">
<h3><span class="header-section-number">4.5.6</span> 小结<a href="交互效应.html#小结" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>除最高阶效应外，所有效应的解释都取决于编码方案</strong>。</p>
<p>使用处理编码，你将查看<strong>简单</strong>效应和<strong>简单</strong>交互效应，而不是<strong>主</strong>效应和<strong>主</strong>交互效应。</p>
<p><strong>求和编码的参数估计与偏差编码只在参数估计的大小上有所不同，但具有相同的解释</strong>。</p>
<p>由于偏差编码不受求和编码中的缩放效应的影响，因此在ANOVA式设计中应默认(建议)使用偏差编码。</p>
<p><strong>R中因子的默认编码方案是“处理”编码</strong>。</p>
<p>因此，每当你将一个变量声明为<code>factor</code>类型，并将该变量用作回归模型中的预测变量时，R将自动创建处理编码操作后的变量。</p>
<div class="yellowbox">
<p><strong>要点：在R中使用回归来分析因子设计时，为了获得主效应和交互效应的经典ANOVA式解释，请使用偏差编码，而不是默认的处理编码</strong>。</p>
</div>

</div>
</div>
</div>
<h3>参考文献<a href="参考文献.html#参考文献" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Lakens_Scheel_Isager_2018" class="csl-entry">
Lakens, D., Scheel, A. M., &amp; Isager, P. M. (2018). Equivalence testing for psychological research: A tutorial. <em>Advances in Methods and Practices in Psychological Science</em>, <em>1</em>, 259–269. <a href="https://journals.sagepub.com/doi/abs/10.1177/2515245918770963">https://journals.sagepub.com/doi/abs/10.1177/2515245918770963</a>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  if (t = document.getElementById("webex-total_correct")) {
    t.innerHTML =
      document.getElementsByClassName("webex-correct").length + " of " +
      document.getElementsByClassName("webex-solveme").length + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

window.onload = function() {
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }

  update_total_correct();
}

</script>
<script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );
});
</script>

            </section>

          </div>
        </div>
      </div>
<a href="多元回归.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="介绍线性混合效应模型.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["CBook.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
